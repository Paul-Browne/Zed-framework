<!DOCTYPE html>
<html>
  <head>
    <title>Zed.js | shop demo</title>
    <script src="https://cdn.jsdelivr.net/npm/zedjs"></script>
    <script id="head">
      Z.mount({
        render: "components/head.html",
        outer: document.getElementById("head")
      });
    </script>
  </head>

  <body>
    <div id="basket"></div>
    <div id="products"></div>
    <div id="view"></div>
    <script>
      Z.mount({
        key: "basket",
        render: "components/spa-shop/basket-simple.html",
        inner: document.getElementById("basket"),
        data: {
          products: JSON.parse(localStorage.getItem("basket")) || [],
          total: JSON.parse(localStorage.getItem("total")) || 0,
          update: function() {
            this.total = 0;
            this.products.forEach(function(product) {
              this.total += product.quantity * product.price;
            }, this);
            localStorage.setItem("basket", JSON.stringify(this.products));
            localStorage.setItem("total", JSON.stringify(this.total));
            Z.update("basket", {
              data: this
            });
          }
        }
      });
      Z.mount({
        key: "products",
        render: "components/spa-shop/products-simple.html",
        inner: document.getElementById("products"),
        data: "/Zed-framework/json/products-simple.json"
      });
      Z.mount({
        key: "view",
        render: "components/spa-shop/view-simple.html",
        inner: document.getElementById("view"),
        data: {}
      });
    </script>
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-36765884-7"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "UA-36765884-7");
    </script>
  </body>
</html>
