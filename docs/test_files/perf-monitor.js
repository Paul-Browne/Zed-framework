"use strict";!function(t){var a={};function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}a.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a.createClass=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t};var o=100,s=null,e=!1,l=[],r=-1;function i(){s||((s=document.createElement("div")).style.cssText="position: fixed;opacity: 0.9;right: 0;bottom: 0",document.body.appendChild(s)),e=!0}function h(t,e,i,n){a.classCallCheck(this,h),this.min=t,this.max=e,this.mean=i,this.now=n}var c=(a.createClass(d,[{key:"addSample",value:function(t){this.samples.length===this.maxSamples&&this.samples.shift(),this.samples.push(t)}},{key:"calc",value:function(){for(var t=this.samples[0],e=this.samples[0],i=0,n=0;n<this.samples.length;n++){var a=this.samples[n];a<t&&(t=a),e<a&&(e=a),i+=a}var s=this.samples[this.samples.length-1],l=i/this.samples.length;return new h(t,e,l,s)}}]),d);function d(){a.classCallCheck(this,d),this.samples=[],this.maxSamples=o}var m=(a.createClass(u,[{key:"addResult",value:function(t){this.results.length===o&&this.results.shift(),this.results.push(t),this.invalidate()}},{key:"invalidate",value:function(){this._dirty||(this._dirty=!0,function(t){l.push(t),-1===r&&requestAnimationFrame(function(t){r=-1;var e=l;l=[];for(var i=0;i<e.length;i++)e[i]()})}(this._syncView))}}]),u);function u(t,e){var r=this,i=arguments.length<=2||void 0===arguments[2]?0:arguments[2];a.classCallCheck(this,u),this._syncView=function(){var t=r.results[r.results.length-1],e=30/(1.2*t.max),i=0==(32&r.flags)?t.min.toFixed(2):""+Math.round(t.min),n=0==(32&r.flags)?t.max.toFixed(2):""+Math.round(t.max),a=0==(32&r.flags)?t.mean.toFixed(2):""+Math.round(t.mean),s=0==(32&r.flags)?t.now.toFixed(2):""+Math.round(t.now);if(r.text.innerHTML=(0==(1&r.flags)?"<div>min: &nbsp;"+i+r.unitName+"</div>":"")+(0==(2&r.flags)?"<div>max: &nbsp;"+n+r.unitName+"</div>":"")+(0==(4&r.flags)?"<div>mean: "+a+r.unitName+"</div>":"")+(0==(8&r.flags)?"<div>now: &nbsp;"+s+r.unitName+"</div>":""),0==(16&r.flags)){r.ctx.fillStyle="#010",r.ctx.fillRect(0,0,o,30),r.ctx.fillStyle="#0f0";for(var l=0;l<r.results.length;l++)r.ctx.fillRect(l,30,1,-r.results[l].now*e)}r._dirty=!1},this.name=t,this.unitName=e,this.flags=i,this.results=[],this.element=document.createElement("div"),this.element.style.cssText="padding: 2px;background-color: #020;font-family: monospace;font-size: 12px;color: #0f0",this.label=document.createElement("div"),this.label.style.cssText="text-align: center",this.label.textContent=this.name,this.text=document.createElement("div"),this.element.appendChild(this.label),this.element.appendChild(this.text),0==(16&i)?(this.canvas=document.createElement("canvas"),this.canvas.style.cssText="display: block; padding: 0; margin: 0",this.canvas.width=o,this.canvas.height=30,this.ctx=this.canvas.getContext("2d"),this.element.appendChild(this.canvas)):(this.canvas=null,this.ctx=null),this._dirty=!1}function f(t,e){a.classCallCheck(this,f),this.data=new c,this.widget=new m(t,e),this.startTime=0}var v={};t.initPerfMonitor=function(t){e||(t.container&&(s=t.container),e=!0)},t.startFPSMonitor=function(){i();var l=new c,r=new m("FPS","",39);s.appendChild(r.element);var o=[],h=0;requestAnimationFrame(function t(e){var i=1/((e-(0===h?e:h))/1e3);if(i!=1/0){64===o.length&&o.shift(),o.push(i);for(var n=0,a=0;a<o.length;a++)n+=o[a];var s=n/o.length;l.addSample(s),r.addResult(l.calc())}h=e,requestAnimationFrame(t)})},t.startMemMonitor=function(){i(),void 0!==performance.memory&&function(){var e=new c,i=new m("Memory","MB",5);s.appendChild(i.element);var n=performance.memory;!function t(){e.addSample(Math.round(n.usedJSHeapSize/1048576)),i.addResult(e.calc()),setTimeout(t,30)}()}()},t.startProfile=function(t){var e=v[t];void 0!==e&&(e.startTime=performance.now())},t.endProfile=function(t){var e=performance.now(),i=v[t];void 0!==i&&(i.data.addSample(e-i.startTime),i.widget.addResult(i.data.calc()))},t.initProfiler=function(t){i();var e=v[t];void 0===e&&(v[t]=e=new f(t,"ms"),s.appendChild(e.widget.element))}}((void 0).perfMonitor=(void 0).perfMonitor||{});