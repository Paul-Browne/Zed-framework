! function(w, d) {
    if (!w.Z) {
        w.Z = {};
        var topics = {};
        function filt(obj) {
            return Object.keys(obj).filter(function(el) {
                return el != "html" && el != "entry";
            })[0];
        }
        Z.update = function(obj) {
            topics[filt(obj)] && topics[filt(obj)](obj);
        }
        Z.render = function(obj, noSubscribe) {
        	console.time(obj.html);
            var x = filt(obj);
            if (x && !noSubscribe) {
                topics[x] = function(data) {
                    for (var key in data) {
                        obj[key] = data[key];
                    }
                    Z.render(obj, true);
                };
            }
            var objResolved = {};
            var arr = obj.html ? [obj.html] : [];
            typeof obj[x] === 'string' ? arr.push(obj[x]) : Z[x] = obj[x];
            arr.forEach(function(url, index) {
                objResolved[index] = "";
                var xhr = new XMLHttpRequest();
                xhr.onreadystatechange = function() {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        objResolved[index] = xhr.responseText;
                        var allResolved = true;
                        for (var key in objResolved) {
                            if (objResolved[key] == "") {
                                allResolved = false;
                            }
                        }
                        if (allResolved) {
                            if (objResolved[1]) {
                                Z[x] = JSON.parse(objResolved[1]);
                            }
                            obj.entry.innerHTML = objResolved[0];
                            var scripts = new DOMParser().parseFromString(objResolved[0], 'text/html').querySelectorAll("SCRIPT");
                            var i = 0;
                            var j = scripts.length;
                            while (i < j) {
                                var newScript = d.createElement("SCRIPT");
                                scripts[i].src ? newScript.src = scripts[i].src : newScript.innerHTML = scripts[i].innerHTML;
                                d.head.appendChild(newScript);
                                i++;
                            }
                            console.timeEnd(obj.html);
                        }
                    }
                };
                xhr.open("GET", url, true);
                xhr.send();
            });
        }
    }
}(window, document);